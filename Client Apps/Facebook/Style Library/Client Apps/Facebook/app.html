<div class="facebook-wp">
    <div class="facebook-wp-panel">
        <div style="top:50px;left:150px;position:relative;">
            <img class="loader-image" />
        </div>
    </div>
</div>

<script type="text/javascript">
    var facebookApp = function () {
        var baseUrl = _spPageContextInfo.siteServerRelativeUrl;
        if (baseUrl.substring(baseUrl.length - 1) === "/") {
            baseUrl = baseUrl.substring(0, baseUrl.length - 1);
        }
        var showLoadingImage = function () {
            $(".facebook-wp .facebook-wp-panel .loader-image")
                .attr("src", baseUrl + "/Style Library/Client Apps/Facebook/img/facebook_ani.gif");;
        };
        var initialiseClientApp = function () {
            showLoadingImage();
            SP.SOD.registerSod("camlbuilder.js", baseUrl + "/Style Library/Client Apps/Common/js/client.camlbuilder.js");
            SP.SOD.registerSod("clientappconfig.js", baseUrl + "/Style Library/Client Apps/Common/js/ClientAppConfig.js");
            SP.SOD.registerSod("facebook.js", baseUrl + "/Style Library/Client Apps/Facebook/js/Facebook.js");
            SP.SOD.registerSod("moment.js", baseUrl + "/Style Library/Client Apps/Common/libs/momentjs/moment.min.js");
            SP.SOD.loadMultiple(["SP.js", "clientappconfig.js", "facebook.js", "moment.js", "camlbuilder.js"], function () {
                if (ClientAppConfig.Config.inDesignMode()) {
                    FacebookClientApp.Facebook.configure($(".facebook-wp-panel"), baseUrl + "/Style Library/Client Apps/Common/img/settings-48.png");
                }
                else {
                    FacebookClientApp.Facebook.start();
                }
            });
        }

        if (!window.jQuery) {
            //Need jQuery before starting client app.
            SP.SOD.registerSod("jquery.js", baseUrl + "/Style Library/Client Apps/Common/libs/jquery-3.2.1/jquery.min.js");
            SP.SOD.executeFunc('jquery.js', null, function () { initialiseClientApp(); });
        } else {
            initialiseClientApp();
        }
    }();
</script>

